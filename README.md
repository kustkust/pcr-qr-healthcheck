# pcr-qr-healthcheck

## Отправка сообщения о состоянии

Для отправки сообщения о состоянии нужно послать на соответствующий канал json следующего вида
```json
{
  "name": "unique_name",
  "status": "string_describing_status"
}
```

## Настройки скрипта в файле `.env`
- `PROJECT_NAME` - имя проекта, используется для названия логов
- `CHECK_INTERVAL` - интервал ***в секундах*** через который производится проверка, когда последний раз было получено сообщение о состоянии
- `RESPONSE_INTERVAL` - максимальное время ожидания сообщения о состоянии ***в секундах***, при превышении этого времени делается запись в лог о том что камера/скрипт перестал отвечать
- `REDIS_HOST` - хост для redis (если программа запущена в docker, а redis локально на этой же машине можно использовать `host.docker.internal`)
- `REDIS_PORT` - порт для redis
- `CAMERA_CHANNEL` - название канала для публикации состояния камер
- `SCRIPT_CHANNEL` - название канала для публикации состояния скриптов
- `OVEN_CHANNEL` - название канала для публикации состояния овнов
- `CAMERAS` - уникальные имена для каждой камеры, пишутся в формате `json` например `'["Uchaly0", "Uchaly1", "Urga0"]'`
- `SCRIPTS` - уникальные имена для каждого скрипта, пишутся в формате `json`, например `'["Uchaly", "Urga"]'`
- `OVENS` - уникальные имена для каждого овна, пишутся в формате `json`, например `'["Oven1"]'`
- `LOG_BACKUP_COUNT` - максимальное количество хранимых файлов логов, один файл - один день
- `LOG_PATH` - папка для логов, например `./logs/`
- `LOCAL_LOG_LEVEL` - уровень логов, например `INFO`

## Docker
Для создания образа
```commandline
docker build -t pcr-qr-healthcheck .
```
Для запуска образа 
```commandline
docker compose up
```